<!-- Simulation control configuration -->
<launch>
    <!-- Load joint controller configurations from YAML file to parameter server -->
    <rosparam command="load" file="$(find segway_sim_control)/config/control/RMP_440LE_control.yaml" />
    
    <!-- load the controllers -->
    <node name="controller_spawner" pkg="controller_manager" type="spawner" respawn="false"
    output="screen"  args="joint_state_controller
				           diff_vel_controller
				           --shutdown-timeout 0.5" />
    
    <node name="cmd_relay" pkg="topic_tools" type="relay" args="segway/cmd_vel diff_vel_controller/cmd_vel "/>
    <node name="feedback_relay" pkg="topic_tools" type="relay" args="diff_vel_controller/odom segway/feedback/wheel_odometry "/>
    
    <!-- This node will take in measurements from odometry, IMU, stamped pose, and stamped twist messages. It tracks
         the state of the robot, with the state vector being defined as X position, Y position, Z position,
         roll, pitch, yaw, their respective velocites, and linear acceleration. Units for all measurements are assumed
         to conform to the SI standard as specified in REP-103. -->
    <node pkg="robot_localization" type="ekf_localization_node" name="ekf_local_localization" clear_params="true">
        <rosparam command="load" 
            file="$(find segway_sim_control)/config/localization_params.yaml"/>
            
        <!-- Need to remap the published estimate to something more meaningful -->
        <remap from="/odometry/filtered" to="/segway/odometry/local_filtered"/>    
    </node>
    
    
    <include file="$(find segway_sim_control)/launch/sim_teleop.launch"/>

    <node name="laser_relay" pkg="topic_tools" type="relay" args="segway/scan segway/filtered_scan "/>
    

</launch>
